<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto Marketing AI Platform</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        
        .tagline {
            font-size: 1.2rem;
            opacity: 0.95;
        }
        
        .status-bar {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }
        
        .status-dot.online {
            background: #10b981;
        }
        
        .status-dot.offline {
            background: #ef4444;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .tab {
            background: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .content-panel {
            display: none;
        }
        
        .content-panel.active {
            display: block;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #374151;
        }
        
        textarea, select, input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        
        textarea:focus, select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .output-section {
            margin-top: 30px;
        }
        
        .output-card {
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 20px;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .output-content {
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        
        .loading.active {
            display: block;
        }
        
        .spinner {
            border: 3px solid #e5e7eb;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .examples {
            background: #f3f4f6;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-top: 15px;
            border-radius: 4px;
        }
        
        .examples h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .example-item {
            padding: 8px 0;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .example-item:hover {
            color: #667eea;
        }
        
        .goal-checkboxes {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üöÄ Auto Marketing AI Platform</h1>
            <p class="tagline">AI-Powered Marketing Content Generation & Optimization</p>
        </header>
        
        <div class="status-bar">
            <div class="status-indicator">
                <span class="status-dot" id="statusDot"></span>
                <span>Server Status: <strong id="statusText">Checking...</strong></span>
            </div>
            <div>
                <span id="modelInfo">Model: OpenRouter Horizon Beta</span>
            </div>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="switchTab('generate')">Generate Content</button>
            <button class="tab" onclick="switchTab('optimize')">Optimize Content</button>
            <button class="tab" onclick="switchTab('variations')">Create Variations</button>
            <button class="tab" onclick="switchTab('test')">Test Connection</button>
        </div>
        
        <!-- Generate Content Panel -->
        <div id="generate-panel" class="content-panel active">
            <div class="card">
                <h2>Generate Marketing Content</h2>
                <form id="generateForm">
                    <div class="form-group">
                        <label for="prompt">Describe your product/service and target audience:</label>
                        <textarea id="prompt" placeholder="E.g., Create a compelling social media post for our new eco-friendly coffee shop targeting millennials who care about sustainability"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="contentType">Content Type:</label>
                        <select id="contentType">
                            <option value="social_post">Social Media Post</option>
                            <option value="email">Email Campaign</option>
                            <option value="blog">Blog Post</option>
                            <option value="ad_copy">Ad Copy</option>
                            <option value="landing_page">Landing Page Copy</option>
                            <option value="press_release">Press Release</option>
                            <option value="general">General Marketing</option>
                        </select>
                    </div>
                    
                    <button type="submit">Generate Content</button>
                </form>
                
                <div class="examples">
                    <h4>Example Prompts:</h4>
                    <div class="example-item" onclick="setExample('generate', 'Launch announcement for our AI-powered project management tool that helps remote teams collaborate better')">
                        üì± "Launch announcement for AI project management tool"
                    </div>
                    <div class="example-item" onclick="setExample('generate', 'Black Friday sale for online fashion store - 50% off everything, targeting young professionals')">
                        üõçÔ∏è "Black Friday fashion sale campaign"
                    </div>
                    <div class="example-item" onclick="setExample('generate', 'Welcome email for new subscribers to our fitness app with personalized workout plans')">
                        üí™ "Welcome email for fitness app subscribers"
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Optimize Content Panel -->
        <div id="optimize-panel" class="content-panel">
            <div class="card">
                <h2>Optimize Existing Content</h2>
                <form id="optimizeForm">
                    <div class="form-group">
                        <label for="content">Your Current Content:</label>
                        <textarea id="content" placeholder="Paste your existing marketing content here to get optimization suggestions and an improved version"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="platform">Target Platform:</label>
                        <select id="platform">
                            <option value="general">General</option>
                            <option value="twitter">Twitter/X</option>
                            <option value="instagram">Instagram</option>
                            <option value="linkedin">LinkedIn</option>
                            <option value="facebook">Facebook</option>
                            <option value="tiktok">TikTok</option>
                            <option value="youtube">YouTube</option>
                            <option value="email">Email</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label>Optimization Goals:</label>
                        <div class="goal-checkboxes">
                            <div class="checkbox-item">
                                <input type="checkbox" id="goal-engagement" value="engagement" checked>
                                <label for="goal-engagement">Engagement</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="goal-conversions" value="conversions" checked>
                                <label for="goal-conversions">Conversions</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="goal-viral" value="viral">
                                <label for="goal-viral">Viral Potential</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="goal-brand" value="brand_awareness">
                                <label for="goal-brand">Brand Awareness</label>
                            </div>
                        </div>
                    </div>
                    
                    <button type="submit">Optimize Content</button>
                </form>
            </div>
        </div>
        
        <!-- Variations Panel -->
        <div id="variations-panel" class="content-panel">
            <div class="card">
                <h2>Generate Content Variations</h2>
                <form id="variationsForm">
                    <div class="form-group">
                        <label for="varPrompt">Base Content or Idea:</label>
                        <textarea id="varPrompt" placeholder="Enter your base content or idea to generate multiple variations for A/B testing"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="varContentType">Content Type:</label>
                        <select id="varContentType">
                            <option value="social_post">Social Media Post</option>
                            <option value="email">Email Subject Lines</option>
                            <option value="ad_copy">Ad Headlines</option>
                            <option value="cta">Call-to-Action Buttons</option>
                            <option value="tagline">Taglines</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="count">Number of Variations:</label>
                        <select id="count">
                            <option value="3">3 Variations</option>
                            <option value="5">5 Variations</option>
                            <option value="7">7 Variations</option>
                            <option value="10">10 Variations</option>
                        </select>
                    </div>
                    
                    <button type="submit">Generate Variations</button>
                </form>
            </div>
        </div>
        
        <!-- Test Connection Panel -->
        <div id="test-panel" class="content-panel">
            <div class="card">
                <h2>Test API Connection</h2>
                <p style="margin-bottom: 20px;">Test the connection to OpenRouter and verify everything is working correctly.</p>
                <div class="button-group">
                    <button onclick="testConnection()">Test Connection</button>
                    <button onclick="checkModels()">List Available Models</button>
                </div>
            </div>
        </div>
        
        <!-- Output Section -->
        <div class="output-section">
            <div class="card">
                <h3>Output</h3>
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>Generating content...</p>
                </div>
                <div class="output-card">
                    <pre class="output-content" id="output">Results will appear here...</pre>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const API = 'http://localhost:3000';
        
        // Check server status
        async function checkStatus() {
            try {
                const res = await fetch(`${API}/health`);
                const data = await res.json();
                const isOnline = data.status === 'healthy';
                
                document.getElementById('statusDot').className = `status-dot ${isOnline ? 'online' : 'offline'}`;
                document.getElementById('statusText').textContent = isOnline ? 'Online' : 'Offline';
                
                // Check OpenRouter status
                const orRes = await fetch(`${API}/api/openrouter/status`);
                const orData = await orRes.json();
                if (orData.configured) {
                    document.getElementById('modelInfo').textContent = `Model: ${orData.defaultModel || 'OpenRouter Horizon Beta'}`;
                }
            } catch (e) {
                document.getElementById('statusDot').className = 'status-dot offline';
                document.getElementById('statusText').textContent = 'Offline';
            }
        }
        
        // Switch tabs
        function switchTab(tabName) {
            // Hide all panels
            document.querySelectorAll('.content-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            // Remove active from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected panel
            document.getElementById(`${tabName}-panel`).classList.add('active');
            
            // Highlight selected tab
            event.target.classList.add('active');
        }
        
        // Set example prompts
        function setExample(type, text) {
            if (type === 'generate') {
                document.getElementById('prompt').value = text;
            } else if (type === 'variations') {
                document.getElementById('varPrompt').value = text;
            }
        }
        
        // Show loading
        function showLoading() {
            document.getElementById('loading').classList.add('active');
            document.getElementById('output').style.display = 'none';
        }
        
        // Hide loading
        function hideLoading() {
            document.getElementById('loading').classList.remove('active');
            document.getElementById('output').style.display = 'block';
        }
        
        // Format output
        function formatOutput(data) {
            if (data.content) {
                return data.content;
            } else if (data.optimization) {
                let output = 'üìä ANALYSIS:\n' + data.optimization.analysis + '\n\n';
                output += '‚ú® OPTIMIZED CONTENT:\n' + data.optimization.optimizedContent + '\n\n';
                if (data.optimization.suggestions && data.optimization.suggestions.length > 0) {
                    output += 'üí° SUGGESTIONS:\n';
                    data.optimization.suggestions.forEach((s, i) => {
                        output += `${i + 1}. ${s}\n`;
                    });
                }
                return output;
            } else if (data.variations) {
                let output = 'üîÑ CONTENT VARIATIONS:\n\n';
                data.variations.forEach((v, i) => {
                    output += `--- Variation ${i + 1} ---\n${v}\n\n`;
                });
                return output;
            } else {
                return JSON.stringify(data, null, 2);
            }
        }
        
        // Generate content
        document.getElementById('generateForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const prompt = document.getElementById('prompt').value;
            const contentType = document.getElementById('contentType').value;
            
            if (!prompt) {
                alert('Please enter a prompt');
                return;
            }
            
            showLoading();
            
            try {
                const res = await fetch(`${API}/api/openrouter/marketing/generate`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({prompt, contentType})
                });
                const data = await res.json();
                document.getElementById('output').textContent = formatOutput(data);
            } catch (e) {
                document.getElementById('output').textContent = 'Error: ' + e.message;
            }
            
            hideLoading();
        });
        
        // Optimize content
        document.getElementById('optimizeForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const content = document.getElementById('content').value;
            const platform = document.getElementById('platform').value;
            
            if (!content) {
                alert('Please enter content to optimize');
                return;
            }
            
            // Get selected goals
            const goals = [];
            document.querySelectorAll('.goal-checkboxes input:checked').forEach(checkbox => {
                goals.push(checkbox.value);
            });
            
            showLoading();
            
            try {
                const res = await fetch(`${API}/api/openrouter/marketing/optimize`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({content, platform, goals})
                });
                const data = await res.json();
                document.getElementById('output').textContent = formatOutput(data);
            } catch (e) {
                document.getElementById('output').textContent = 'Error: ' + e.message;
            }
            
            hideLoading();
        });
        
        // Generate variations
        document.getElementById('variationsForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const prompt = document.getElementById('varPrompt').value;
            const count = document.getElementById('count').value;
            const contentType = document.getElementById('varContentType').value;
            
            if (!prompt) {
                alert('Please enter a prompt');
                return;
            }
            
            showLoading();
            
            try {
                const res = await fetch(`${API}/api/openrouter/marketing/variations`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({prompt, count: parseInt(count), contentType})
                });
                const data = await res.json();
                document.getElementById('output').textContent = formatOutput(data);
            } catch (e) {
                document.getElementById('output').textContent = 'Error: ' + e.message;
            }
            
            hideLoading();
        });
        
        // Test connection
        async function testConnection() {
            showLoading();
            
            try {
                const res = await fetch(`${API}/api/openrouter/test`);
                const data = await res.json();
                document.getElementById('output').textContent = 
                    `‚úÖ Connection Test ${data.success ? 'Successful' : 'Failed'}\n\n` +
                    `Response: ${data.response}\n\n` +
                    `Model: ${data.model}\n` +
                    `Tokens Used: ${data.usage ? data.usage.total_tokens : 'N/A'}`;
            } catch (e) {
                document.getElementById('output').textContent = 'Error: ' + e.message;
            }
            
            hideLoading();
        }
        
        // Check available models
        async function checkModels() {
            showLoading();
            
            try {
                const res = await fetch(`${API}/api/openrouter/models`);
                const data = await res.json();
                let output = 'ü§ñ Available AI Models:\n\n';
                output += `Recommended: ${data.recommended}\n\n`;
                output += 'All Models:\n';
                data.models.forEach((model, i) => {
                    output += `${i + 1}. ${model}\n`;
                });
                document.getElementById('output').textContent = output;
            } catch (e) {
                document.getElementById('output').textContent = 'Error: ' + e.message;
            }
            
            hideLoading();
        }
        
        // Initialize
        checkStatus();
        setInterval(checkStatus, 30000); // Check status every 30 seconds
    </script>
</body>
</html>